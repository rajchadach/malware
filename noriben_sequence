import pandas as pd
import csv

df_hash = pd.read_csv("static.csv")
f = open("noriben_seq.csv", "w")
csvWriter = csv.DictWriter(f, fieldnames=["Filename"]+["n"+ str(i) for i in range(10000)])
csvWriter.writeheader()
f.close()

for root, dirs, files in os.walk("/content/gdrive/My Drive/Noriben_CSVs"):
        for file1 in sorted(files, key=lambda x: str(x)):
            filename = str(file1).split(".")[0].split("_")[-1]
            df1 = pd.read_csv(os.path.join(root, file1))
            op_all = []
            for index, row in df1.iterrows():
                if str(row['Process Name']) == "test.exe":
                    op_all.append(str(row['Operation']))

            i=0
            op_seq = []
            op_seq.append(filename)
            for seq in op_all:
                if i < 10000:
                    op_seq.append(seq)
                    i+=1

            with open('noriben_seq.csv', 'a+', encoding="ISO-8859-1", newline='') as f:
                writer = csv.writer(f)
                writer.writerows([op_seq])

df_nori = pd.read_csv("noriben_seq.csv")
df_nori["Labels"] = df_nori.apply(lambda df_csv1: df_hash[(df_hash["Filename"] == df_nori["Filename"])]["Label_Virus"].values, axis=1)
