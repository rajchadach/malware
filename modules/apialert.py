#!/usr/bin/env python
# -*- coding: utf-8 -*-

def get_result(pe, strings_match):
	alerts = []
	try:
		for entry in pe.DIRECTORY_ENTRY_IMPORT:
			for imp in entry.imports:
				func = imp.name.decode('utf-8')
				for alert in strings_match:
					if alert and func != None: # remove 'null'
						if func.startswith(alert):
							alerts.append(func)
		if len(alerts) == 1:
			return str(alerts[0])
		elif not alerts:
			return "N/A"
		else:
			return str(sorted(set(alerts)))
	except:
		return None
	#print(alerts)
